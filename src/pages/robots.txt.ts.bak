import type { APIRoute } from "astro";

export const GET: APIRoute = async () => {
    const siteUrl = import.meta.env.PUBLIC_SITE_URL; // || "https://oasishealthservices.com";
    const isProd = import.meta.env.PROD;

    const privatePaths = ['/thank-you', '/privacy-policy', '/terms-and-conditions'];

    const disallowRules = privatePaths.map(path => `Disallow: ${path}`).join('\n');

    const robots = isProd ? `# Production Environment
User-agent: *
Allow: /
${disallowRules}

# Sitemap & AI Discovery
Sitemap: ${new URL('sitemap-index.xml', siteUrl).href}
llms: ${new URL('llms.txt', siteUrl).href}

# Block AI scrapers
User-agent: GPTBot
Disallow: /
User-agent: CCBot
Disallow: /` : `# Test Environment
User-agent: *
Disallow: /`;

    return new Response(robots, {
        headers: {
            'Content-Type': 'text/plain; charset=utf-8'
        }
    })
}